name: create-and-update-check-run-on-push
on: push

jobs:
  create-and-update-check-run:
    runs-on: ubuntu-latest
    steps:
    - name: Create & update check run
      uses: actions/github-script@v4.0.2
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
        debug: true
        previews: 'antiope-preview'
        script: |
          const { data: checkRun } = await github.checks.create({
            owner: context.repo.owner,
            repo: context.repo.repo,
            name: "Actions-created check run by workflow in actions-packages-examples/github-script__playground",
            head_sha: context.payload.after
          })
          
          const result = await github.checks.update({
            owner: context.repo.owner,
            repo: context.repo.repo,
            check_run_id: checkRun.id,
            conclusion: "neutral"
          })
          
          console.log(result)
